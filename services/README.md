# Services Directory (`services/`)

(Generated by Gemini 2.5 Pro)

This directory contains modules responsible for interacting with external APIs and services.

## Purpose

To abstract the details of external API communication, keeping the core application logic separate from the specifics of network requests, authentication, and data parsing for third-party services.

## Key Services

### `openai.ts`

- **Purpose**: Interacts with the OpenAI API, specifically the `gpt-4o` model via the Chat Completions endpoint.
- **Key Functions**:
  - `extractIngredients(base64Image: string): Promise<IngredientResponse>`: Takes a base64 encoded image, sends it to GPT-4o with a specific system prompt to identify ingredients, and expects a JSON response containing an array of ingredient strings (`{ ingredients: string[], description?: string }`). It handles sending the image data, setting the authorization header, and parsing the JSON response.
- **Configuration**: Requires the `EXPO_PUBLIC_OPENAI_API_KEY` environment variable to be set.

### `spoonacular.ts`

- **Purpose**: Interacts with the Spoonacular Food API to fetch recipe information.
- **Key Functions**:
  - `fetchRecipesByIngredients(ingredients: string[], sortPreference: RecipeSortPreference, offset: number): Promise<SpoonacularRecipe[]>`: Searches for recipes based on a list of ingredients, applying user sorting preferences and pagination (offset). Returns an array of basic recipe information (`SpoonacularRecipe`).
  - `fetchRecipeDetailsById(id: number | string): Promise<RecipeDetails>`: Fetches detailed information for a specific recipe ID, including ingredients, instructions, etc. (`RecipeDetails`).
- **Data Types**: Exports interfaces for Spoonacular data structures (`SpoonacularRecipe`, `RecipeDetails`, `RecipeIngredient`, `AnalyzedInstruction`, etc.).
- **Configuration**: Requires the `EXPO_PUBLIC_SPOONACULAR_API_KEY` environment variable to be set.

## Development Guidelines

- Each service should ideally correspond to a specific external API (e.g., Spoonacular, OpenAI).
- Functions within a service module should handle constructing API requests, sending them, and parsing the responses into well-defined types/interfaces.
- Handle API keys and sensitive information securely using environment variables (prefixed with `EXPO_PUBLIC_` for client-side access if necessary, following Expo guidelines).
- Implement robust error handling for network issues and API-specific errors.

## Usage

Service functions are typically called from custom hooks (`hooks/`) or potentially from data-fetching logic within screen components (though using hooks is preferred).

```tsx
// Example usage within a hook (e.g., useRecipeSuggestions)
import { fetchRecipesByIngredients } from "@/services/spoonacular";

async function getRecipes(ingredients, sortPref, offset) {
  try {
    const recipes = await fetchRecipesByIngredients(
      ingredients,
      sortPref,
      offset
    );
    // ... handle success ...
  } catch (error) {
    // ... handle error ...
  }
}
```
